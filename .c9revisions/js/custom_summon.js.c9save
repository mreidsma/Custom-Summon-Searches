{"ts":1341353217679,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"// Custom Summon Boxes\n\t// Grand Valley State University Library Labs, 2011, 2012\n\t// by Matthew Reidsma, reidsmam@gvsu.edu with help from John Krull, astrom.flux@gmail.com\n\t// \n\t// Released under Creative Commons Attribution 3.0 Unported License\n\t// http://creativecommons.org/licenses/by/3.0/\n\t//\n\n$(function() {\n\t\n\tfunction selectText(element) {\n\t    var text = document.getElementById(element);    \n\n\t    if (document.body.createTextRange) { // ms\n\t        var range = document.body.createTextRange();\n\t        range.moveToElementText(text);\n\t        range.select();\n\t    } else if (window.getSelection) { // moz, opera, webkit\n\t        var selection = window.getSelection();            \n\t        var range = document.createRange();\n\t        range.selectNodeContents(text);\n\t        selection.removeAllRanges();\n\t        selection.addRange(range);\n\t    }\n\t}\n\t\n\n\t// Handle the checkboxes\n\n\t$(\":checkbox\").click(function() {\n\n\t\tvar data = this.value.split(\"|\");\n\t\tvar textInput = 'input type=\"hidden\" name=\"' + data[0] + '\" value=\\'' + data[1] + data[2] + '\\' /';\n\n\t\tif ($(this).attr('checked')) {\n\n\t\t\t$(\"#search-refinements\").append('&lt;' + textInput + '&gt;<br/>');\n\n\t\t} else { // Unchecked\n\n\t\t\tvar value = $(\"#search-refinements\").text();\n\t\t\tvalue = value.replace('<' + textInput + '>', \"\");\n\t\t\tvalue = value.replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\n\t\t\tvalue = value.replace(/&gt;/g,\"&gt;<br />\");\n\t\t\t$(\"#search-refinements\").html(value);\n\t\t\t\n\t\t}\n\n\t});\n\t\n\t\n\t// Date filter\n\t$(\"#start_year, #end_year\").keyup(refreshDateRange);\n\t$(\"#start_month, #start_day, #end_month, #end_day\").change(refreshDateRange);\n\t\n\tfunction refreshDateRange() {\n\n\t\tvar start_year = $(\"#start_year\").val();\n\t\tvar end_year   = $(\"#end_year\").val();\n\t\t\n\t\tif(end_year.length > 3) {\n\t\t\n\t\t\tvar start_range = '*';\n\t\t\tvar start_month = parseInt($(\"#start_month\").val()) || '';\n\t\t\tvar start_day   = parseInt($(\"#start_day\").val()) || '';\n\t\t\tvar end_month   = parseInt($(\"#end_month\").val()) || '';\n\t\t\tvar end_day     = parseInt($(\"#end_day\").val()) || '';\n\n\t\t\tif(start_month > 0) { start_month = '-' + (start_month.length < 2 ? \"0\" + start_month : start_month); } // Pad with zeros \n\t\t\tif(start_day > 0)   { start_day = '-' + (start_day.length < 2 ? \"0\" + start_day : start_day);         } // Pad with zeros\n\t\t\tif(start_year > 0)  { start_range = start_year + start_month + start_day; }\n\t\t\n\t\t\tif(end_month > 0) { end_month = '-' + (end_month.length < 2 ? \"0\" + end_month : end_month);           } // Pad with zeros\n\t\t\tif(end_day > 0)   {\tend_day = '-' + (end_day.length < 2 ? \"0\" + end_day : end_day);                   } // Pad with zeros\n\n\t\t\tend_range = end_year + end_month + end_day;\n\t\t\t\n\t\t\t$(\"#insert-pubdate\").html('&lt;input type=\"hidden\" name=\"s.rf\" value=\"PublicationDate,' + start_range + ':' + end_range + '\" /&gt;<br />');\n\t\t\t$(\"#search-refinements\").html( $(\"#search-refinements\").html() ); // Bug fix for Chrome\n\t\t}\n\n\t}\n\t\n\t$(\"#keywords\").keyup(function() {\n\t\tvar subject_terms = '&lt;input type=\"hidden\" name=\"s.fvgf[]\" value=\"SubjectTerms,or,' + this.value + '\" /&gt;<br />';\n\t\t$(\"#insertterms\").html(this.value ? subject_terms : '');\n\t});\n\t\n\t$(\".accordian-body\").hide();\n\t\n\t$(\".accordian-head\").find(\"h2\").prepend(\"<span>&#9656;</span>\");\n\t\n\t$(\".accordian-head\").click(function() {\n\t\tvar arrow = $(this).find(\"h2 span\").html();\n\t\t$(this).next(\".accordian-body\").slideToggle(400);\n\t\tif(arrow == \"<span>â–¾</span>\") {\n\t\t\t$(this).find(\"h2 span\").html(\"<span>&#9656;</span>\");\n\t\t} else {\n\t\t\t$(this).find(\"h2 span\").html(\"<span>&#9662;</span>\");\n\t\t}\n\t});\n\t\n\t$(\"#codeblock\").prepend('<div class=\"copybutton lib-button-small-grey\">Select All</div>');\n\t\n\t$(\".copybutton\").click(function(){\n\t    selectText(\"summon-code\");\n\t  });\n\t\n\t$(\"#clear-dates-button\").click(function() {\n\t\t$(\"#insert-pubdate\").html(\"\");\n\t\t$(\".dates\").val(\"\");\n\t\t$(\"select option:selected\").removeAttr(\"selected\");\n\t});\n});"]],"start1":0,"start2":0,"length1":0,"length2":3878}]],"length":3878}
{"contributors":[],"silentsave":false,"ts":1341353669429,"patch":[[{"diffs":[[0,"ment) {\n"],[-1,"\t"],[1,"    "],[0,"    var "]],"start1":341,"start2":341,"length1":17,"length2":20},{"diffs":[[0,"nt);"],[1,"\n"],[0,"    "],[-1,"\n\n\t"],[0,"    "],[-1,"if (document.body.createTextRange) { // ms\n\t        var range = "],[1,"var range = (document.createRange ? document.createRange() : document.body.createTextRange());\n\n        if ("],[0,"docu"]],"start1":397,"start2":397,"length1":83,"length2":125},{"diffs":[[0,"ateTextRange"],[-1,"();\n\t"],[1,") { // ms\n    "],[0,"        rang"]],"start1":535,"start2":535,"length1":29,"length2":38},{"diffs":[[0,"mentText(text);\n"],[-1,"\t"],[1,"    "],[0,"        range.se"]],"start1":584,"start2":584,"length1":33,"length2":36},{"diffs":[[0,"e.select();\n"],[-1,"\t"],[1,"    "],[0,"    } else i"]],"start1":616,"start2":616,"length1":25,"length2":28},{"diffs":[[0," webkit\n"],[-1,"\t"],[1,"    "],[0,"        "]],"start1":684,"start2":684,"length1":17,"length2":20},{"diffs":[[0,"n();"],[1,"\n"],[0,"    "],[-1,"        \n\t        var range = document.createRange();\n\t"],[0,"    "]],"start1":738,"start2":738,"length1":67,"length2":13},{"diffs":[[0,"(text);\n"],[-1,"\t"],[1,"   "],[0,"        "],[1," "],[0,"selectio"]],"start1":779,"start2":779,"length1":25,"length2":28},{"diffs":[[0,"nges();\n"],[-1,"\t"],[1,"    "],[0,"        "]],"start1":820,"start2":820,"length1":17,"length2":20},{"diffs":[[0,"range);\n"],[-1,"\t"],[1,"    "],[0,"    }\n\t}"]],"start1":859,"start2":859,"length1":17,"length2":20},{"diffs":[[0,"ckboxes\n"],[-1,"\n"],[0,"\t$(\":che"]],"start1":901,"start2":901,"length1":17,"length2":16}]],"length":3895,"saved":false}
{"contributors":[],"silentsave":false,"ts":1342154704245,"patch":[[{"diffs":[[0,"n Boxes\n"],[-1,"\t"],[1,"    "],[0,"// Grand"]],"start1":15,"start2":15,"length1":17,"length2":20},{"diffs":[[0,"1, 2012\n"],[-1,"\t"],[1,"    "],[0,"// by Ma"]],"start1":77,"start2":77,"length1":17,"length2":20},{"diffs":[[0,"() {"],[-1,"\n\t\n\tfunction selectText(element) {\n        var text = document.getElementById(element);\n        var range = (document.createRange ? document.createRange() : document.body.createTextRange());\n\n        if (document.body.createTextRange) { // ms\n            range.moveToElementText(text);\n            range.select();\n        } else if (window.getSelection) { // moz, opera, webkit\n            var selection = window.getSelection();\n            range.selectNodeContents(text);\n            selection.removeAllRanges();\n            selection.addRange(range);\n        }\n\t}\n\t"],[0,"\n\n\t/"]],"start1":316,"start2":316,"length1":575,"length2":8},{"diffs":[[0,"e);\n"],[-1,"\t\t\t"],[1,"            "],[0,"\n\t\t}\n"],[-1,"\n"],[0,"\t});\n\t\n"],[-1,"\t\n"],[0,"\t// "]],"start1":901,"start2":901,"length1":26,"length2":32},{"diffs":[[0,"eRange() {\n\n"],[1,"        var full_range = '';\n"],[0,"\t\tvar start_"]],"start1":1100,"start2":1100,"length1":24,"length2":53},{"diffs":[[0,"\n\t\t\n"],[-1,"\t\tif(end_year.length > 3) {\n\t\t\n\t\t\tvar start_range = '*';\n\t"],[0,"\t\tva"]],"start1":1224,"start2":1224,"length1":66,"length2":8},{"diffs":[[0,"rt_month\").val()"],[1,", 10"],[0,") || '';\n\t\t\tvar "]],"start1":1264,"start2":1264,"length1":32,"length2":36},{"diffs":[[0," 10) || '';\n"],[-1,"\t"],[0,"\t\tvar start_"]],"start1":1281,"start2":1281,"length1":25,"length2":24},{"diffs":[[0,"_day\").val()"],[-1,")"],[1,", 10)  "],[0," || '';\n"],[-1,"\t"],[0,"\t\tvar end_mo"]],"start1":1331,"start2":1331,"length1":34,"length2":39},{"diffs":[[0,"\").val()"],[-1,")"],[1,", 10)  "],[0," || '';\n"],[-1,"\t"],[0,"\t\tvar en"]],"start1":1400,"start2":1400,"length1":26,"length2":31},{"diffs":[[0,"\").val()"],[-1,")"],[1,", 10)    "],[0," || '';\n"]],"start1":1463,"start2":1463,"length1":17,"length2":25},{"diffs":[[0,"|| '';\n\n"],[-1,"\t"],[0,"\t\tif(sta"]],"start1":1481,"start2":1481,"length1":17,"length2":16},{"diffs":[[0,"eros \n\t\t"],[-1,"\t"],[0,"if(start"]],"start1":1608,"start2":1608,"length1":17,"length2":16},{"diffs":[[0,"ros\n"],[-1,"\t\t\tif(start_year > 0)  { start_range = start_year + start_month + start_day; }\n\t\t\n\t"],[0,"\t\tif"]],"start1":1734,"start2":1734,"length1":91,"length2":8},{"diffs":[[0,"h zeros\n"],[-1,"\t"],[0,"\t\tif(end"]],"start1":1854,"start2":1854,"length1":17,"length2":16},{"diffs":[[0," zeros\n\n"],[-1,"\t\t\t"],[1,"        var start_range = start_year ? (start_year + (start_month && start_day ? start_month + start_day : '')) : '*';\n        var "],[0,"end_rang"]],"start1":1979,"start2":1979,"length1":19,"length2":147},{"diffs":[[0,"d_range "],[1,"  "],[0,"= end_ye"]],"start1":2120,"start2":2120,"length1":16,"length2":18},{"diffs":[[0,"nd_year "],[1,"  ? (end_year   "],[0,"+ "],[1,"("],[0,"end_mont"]],"start1":2133,"start2":2133,"length1":18,"length2":35},{"diffs":[[0,"nth "],[-1,"+ end_day;\n\t"],[1,"  && end_day   ? end_month   + end_day   : '')) : '*';\n        \n        if(start_range == '*' && end_range == '*') { full_range = ''; } else { full_range = start_range + ':' + end_range; }\n"],[0,"\t\t\n"],[-1,"\t"],[0,"\t\t$("]],"start1":2166,"start2":2166,"length1":24,"length2":200},{"diffs":[[0,"\").html("],[1,"full_range ? "],[0,"'&lt;inp"]],"start1":2382,"start2":2382,"length1":16,"length2":29},{"diffs":[[0,"ate,' + "],[-1,"start_range + ':' + end"],[1,"full"],[0,"_range +"]],"start1":2459,"start2":2459,"length1":39,"length2":20},{"diffs":[[0,";<br />'"],[1," : ''"],[0,");\n"],[-1,"\t"],[0,"\t\t$(\"#se"]],"start1":2487,"start2":2487,"length1":20,"length2":24},{"diffs":[[0,"ome\n"],[-1,"\t\t}\n\n"],[0,"\t}\n\t"]],"start1":2589,"start2":2589,"length1":13,"length2":8},{"diffs":[[0,"{\n\t\t"],[-1,"var subject_terms ="],[1,"$(\"#insertterms\").html(this.value ?"],[0," '&l"]],"start1":2631,"start2":2631,"length1":27,"length2":43},{"diffs":[[0," />'"],[-1,";\n\t\t$(\"#insertterms\").html(this.value ? subject_terms"],[0," : '"]],"start1":2763,"start2":2763,"length1":61,"length2":8},{"diffs":[[0,"pan>\");\n"],[-1,"\t\n"],[0,"\t$(\".acc"]],"start1":2872,"start2":2872,"length1":18,"length2":16},{"diffs":[[0,"ion() {\n"],[-1,"\t\t"],[1,"        "],[0,"var arro"]],"start1":2913,"start2":2913,"length1":18,"length2":24},{"diffs":[[0,"ar arrow"],[1,"El"],[0," = $(thi"]],"start1":2930,"start2":2930,"length1":16,"length2":18},{"diffs":[[0,"\"h2 span"],[-1,"\").html("],[1," span\""],[0,");\n\t\t$(t"]],"start1":2956,"start2":2956,"length1":24,"length2":22},{"diffs":[[0,"rrow"],[-1," == \"<span>â–¾</span>\") {\n\t\t\t$(this).find(\"h2 span\")"],[1,"El.html() == \"?\") {\n\t\t\tarrowEl"],[0,".html(\""],[-1,"<span>"],[0,"&#9656;"],[-1,"</span>"],[0,"\");\n"]],"start1":3031,"start2":3031,"length1":85,"length2":52},{"diffs":[[0,"\n\t\t\t"],[-1,"$(this).find(\"h2 span\")"],[1,"arrowEl"],[0,".html(\""],[-1,"<span>"],[0,"&#9662;"],[-1,"</span>"],[0,"\");\n"]],"start1":3093,"start2":3093,"length1":58,"length2":29},{"diffs":[[0,"on()"],[1," "],[0,"{\n"],[-1,"\t"],[1,"  "],[0,"    "],[-1,"selectText(\"summon-code\");\n\t  "],[1,"  var text = document.getElementById(\"summon-code\");\n        var range = (document.createRange ? document.createRange() : document.body.createTextRange());\n\n        if (document.body.createTextRange) { // ms\n            range.moveToElementText(text);\n            range.select();\n        } else if (window.getSelection) { // moz, opera, webkit\n            var selection = window.getSelection();\n            range.selectNodeContents(text);\n            selection.removeAllRanges();\n            selection.addRange(range);\n        }\n\t"],[0,"});\n"]],"start1":3257,"start2":3257,"length1":45,"length2":546}]],"length":3968,"saved":false}
